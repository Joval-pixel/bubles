<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Bubles — Ações ao Vivo</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #000;
      font-family: 'Arial', sans-serif;
    }

    h1 {
      color: cyan;
      text-align: center;
      margin: 20px 0;
      font-weight: bold;
    }

    canvas {
      display: block;
    }
  </style>
</head>
<body>
  <h1>Bubles — Ações ao Vivo</h1>
  <canvas id="bubbleCanvas"></canvas>

  <script>
    const canvas = document.getElementById("bubbleCanvas");
    const ctx = canvas.getContext("2d");

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }

    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    const bubbles = [
      { ticker: "VALE3", change: 2.41 },
      { ticker: "PETR4", change: -1.82 },
      { ticker: "MGLU3", change: -6.59 },
      { ticker: "CSNA3", change: 6.13 },
      { ticker: "HAPV3", change: -5.14 },
      { ticker: "SUZB3", change: 3.73 },
      { ticker: "WEGE3", change: -0.17 },
      { ticker: "ITUB4", change: 0.78 },
      { ticker: "BBAS3", change: 1.36 },
      { ticker: "LREN3", change: -3.31 },
      { ticker: "BBDC4", change: -0.91 },
      { ticker: "PRIO3", change: 0.86 },
      { ticker: "GGBR4", change: 3.13 }
    ];

    const spacing = 130;
    const positions = [];
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;

    function getBubbleColor(change) {
      return change >= 0 ? "#00FF5F" : "#FF0033";
    }

    function drawBubble(x, y, radius, color, text1, text2) {
      ctx.beginPath();
      ctx.shadowBlur = 20;
      ctx.shadowColor = color;
      ctx.fillStyle = color;
      ctx.arc(x, y, radius, 0, Math.PI * 2);
      ctx.fill();
      ctx.closePath();

      ctx.shadowBlur = 0;
      ctx.fillStyle = "#fff";
      ctx.textAlign = "center";

      // Ajuste automático do tamanho da fonte
      ctx.font = `bold ${Math.max(12, radius * 0.35)}px Arial`;
      ctx.fillText(text1, x, y - 5);
      ctx.font = `${Math.max(10, radius * 0.25)}px Arial`;
      ctx.fillText(text2, x, y + 15);
    }

    function drawBubbles() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      positions.length = 0;

      bubbles.forEach((bubble, i) => {
        const radius = Math.max(30, Math.abs(bubble.change) * 8);
        let x, y, tries = 0;

        do {
          x = Math.random() * (canvas.width - 2 * radius) + radius;
          y = Math.random() * (canvas.height - 2 * radius) + radius;
          tries++;
          if (tries > 300) break;
        } while (positions.some(p => Math.hypot(p.x - x, p.y - y) < p.r + radius + 5));

        positions.push({ x, y, r: radius });

        const color = getBubbleColor(bubble.change);
        const changeText = (bubble.change > 0 ? "+" : "") + bubble.change.toFixed(2) + "%";
        drawBubble(x, y, radius, color, bubble.ticker, changeText);
      });
    }

    drawBubbles();
    setInterval(drawBubbles, 7000);
  </script>
</body>
</html>