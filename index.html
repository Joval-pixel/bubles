import zipfile
from pathlib import Path

# Nome do novo arquivo corrigido com estilo inspirado no CryptoBubbles
zip_path = Path("/mnt/data/bubles-estilo-cryptobubbles.zip")

# Criando um novo index.html com ajustes visuais e comportamento refinado
html_content = """
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BUBLES – A BOLSA QUE RESPIRA</title>
  <style>
    body {
      margin: 0;
      background-color: #000;
      overflow: hidden;
      font-family: Arial, sans-serif;
      color: white;
    }
    header {
      text-align: center;
      padding: 10px;
      background: #111;
      font-size: 24px;
      font-weight: bold;
    }
    canvas {
      display: block;
    }
    .bubble {
      position: absolute;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
      font-weight: bold;
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
      transition: transform 0.5s;
    }
  </style>
</head>
<body>
  <header>BUBLES – A BOLSA QUE RESPIRA</header>
  <canvas id="canvas"></canvas>
  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const data = [
      { ticker: "PETR4", change: 1.23 },
      { ticker: "VALE3", change: -2.56 },
      { ticker: "ITUB4", change: 0.87 },
      { ticker: "BBDC4", change: -1.13 },
      { ticker: "JBSS3", change: 3.02 },
      { ticker: "ABEV3", change: -0.76 },
    ];

    const bubbles = data.map((d, i) => ({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height,
      r: Math.max(30, Math.abs(d.change) * 20),
      dx: (Math.random() - 0.5) * 1.5,
      dy: (Math.random() - 0.5) * 1.5,
      color: d.change >= 0 ? "lime" : "red",
      text: `${d.ticker}\n${d.change > 0 ? "+" : ""}${d.change.toFixed(2)}%`,
    }));

    function drawBubble(b) {
      ctx.beginPath();
      ctx.arc(b.x, b.y, b.r, 0, Math.PI * 2);
      ctx.fillStyle = b.color;
      ctx.shadowColor = b.color;
      ctx.shadowBlur = 25;
      ctx.fill();
      ctx.shadowBlur = 0;
      ctx.fillStyle = "white";
      ctx.font = `${Math.max(12, b.r / 3)}px Arial`;
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillText(b.text.split("\n")[0], b.x, b.y - 10);
      ctx.fillText(b.text.split("\n")[1], b.x, b.y + 10);
    }

    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      bubbles.forEach((b) => {
        b.x += b.dx;
        b.y += b.dy;

        if (b.x - b.r < 0 || b.x + b.r > canvas.width) b.dx *= -1;
        if (b.y - b.r < 0 || b.y + b.r > canvas.height) b.dy *= -1;

        drawBubble(b);
      });
      requestAnimationFrame(animate);
    }

    animate();
  </script>
</body>
</html>
"""

# Salvar o HTML em um arquivo
html_path = Path("/mnt/data/index.html")
html_path.write_text(html_content, encoding="utf-8")

# Empacotar em .zip
with zipfile.ZipFile(zip_path, "w") as zipf:
    zipf.write(html_path, arcname="index.html")

zip_path.name
