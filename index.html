<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Bubles — Ações ao Vivo</title>
  <style>
    html, body {
      margin: 0;
      overflow: hidden;
      background: #0e0e11;
      font-family: Arial, sans-serif;
    }
    h1 {
      color: cyan;
      text-align: center;
      margin-top: 20px;
    }
    .bubble {
      position: absolute;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
      font-weight: bold;
      color: white;
      border: 3px solid white;
      text-shadow: 0 0 5px black;
      white-space: nowrap;
      padding: 4px;
      flex-direction: column;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <h1>Bubles — Ações ao Vivo</h1>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script>
    const dados = [
      { ticker: "VALE3", change: 2.41 },
      { ticker: "PETR4", change: -1.82 },
      { ticker: "ITUB4", change: 0.78 },
      { ticker: "MGLU3", change: -6.59 },
      { ticker: "BBAS3", change: 1.36 },
      { ticker: "SUZB3", change: 3.73 },
      { ticker: "HAPV3", change: -5.14 },
      { ticker: "CSNA3", change: 6.13 },
      { ticker: "BBDC4", change: -0.91 },
      { ticker: "PRIO3", change: 0.86 },
      { ticker: "WEGE3", change: -0.17 },
      { ticker: "LREN3", change: -3.31 },
      { ticker: "GGBR4", change: 3.13 }
    ];

    const width = window.innerWidth;
    const height = window.innerHeight;

    const nodes = dados.map(d => {
      const size = 60 + Math.abs(d.change) * 10;
      const fontSize = size < 80 ? 10 : size < 120 ? 14 : 16;
      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      bubble.style.width = size + 'px';
      bubble.style.height = size + 'px';
      bubble.style.fontSize = fontSize + 'px';
      bubble.innerHTML = `
        <div>${d.ticker}</div>
        <div>${d.change >= 0 ? '+' : ''}${d.change.toFixed(2)}%</div>
      `;
      if (d.change >= 0) {
        bubble.style.background = 'radial-gradient(circle, #00ff80, #00aa44)';
        bubble.style.boxShadow = '0 0 25px #00ff80';
      } else {
        bubble.style.background = 'radial-gradient(circle, #ff4d4d, #a80000)';
        bubble.style.boxShadow = '0 0 25px #ff4d4d';
      }
      document.body.appendChild(bubble);
      return { ...d, r: size / 2, el: bubble };
    });

    const simulation = d3.forceSimulation(nodes)
      .force("x", d3.forceX(width / 2).strength(0.02))
      .force("y", d3.forceY(height / 2 + 40).strength(0.02))
      .force("collide", d3.forceCollide().radius(d => d.r + 4).iterations(3))
      .force("charge", d3.forceManyBody().strength(1))
      .velocityDecay(0.2)
      .alpha(0.9)
      .alphaDecay(0.005)
      .on("tick", () => {
        nodes.forEach(d => {
          d.x = Math.max(d.r, Math.min(width - d.r, d.x));
          d.y = Math.max(d.r + 40, Math.min(height - d.r, d.y));
          d.el.style.left = `${d.x - d.r}px`;
          d.el.style.top = `${d.y - d.r}px`;
        });
      });
  </script>
</body>
</html>